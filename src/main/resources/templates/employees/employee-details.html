<!DOCTYPE html>
<html
  lang="es"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{fragments/layout}"
>
  <head>
    <title>Detalles del Contrato</title>
    <link rel="stylesheet" th:href="@{/css/contract.css}" />
  </head>

  <body>
    <div layout:fragment="content">
      <!-- Contract Header -->
      <div class="contract-header-section fade-in">
        <div class="contract-header-content">
          <div
            class="contract-avatar-large"
            th:text="${contract.firstName.substring(0,1) + contract.lastName.substring(0,1)}"
          >
            JD
          </div>
          <div class="contract-header-info">
            <h1
              class="contract-header-title"
              th:text="${contract.firstName + ' ' + contract.lastName}"
            >
              Nombre del Empleado
            </h1>
            <div class="contract-header-meta">
              <span class="contract-badge">
                <i class="bi bi-briefcase-fill"></i>
                <span th:text="${contract.jobType.label}">Puesto</span>
              </span>
              <span class="contract-badge">
                <i class="bi bi-calendar-check"></i>
                <span th:text="${contract.employmentType.label}">Tipo</span>
              </span>
              <span class="contract-badge">
                <i class="bi bi-hourglass-split"></i>
                <span th:text="${contract.service} + ' años'">Antigüedad</span>
              </span>
            </div>
            <div class="contract-header-actions">
              <a
                th:href="@{/contracts/updateForm/{id}(id=${contract.contractId})}"
                class="btn"
              >
                <i class="bi bi-pencil-square me-2"></i>
                Actualizar Datos
              </a>
              <a
                th:href="@{/jobs/jobList/{id}(id=${contract.contractId})}"
                class="btn"
              >
                <i class="bi bi-clock-history me-2"></i>
                Ver Tareas
              </a>
              <a
                th:href="@{/attendance/view/{scheduleId}(scheduleId=${contract.scheduleId}, year=${contract.year}, month=${contract.month})}"
                class="btn"
              >
                <i class="bi bi-calendar-check me-2"></i>
                Asistencias
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Modern Tabs -->
      <div class="modern-tabs slide-in">
        <ul class="nav nav-tabs" id="contractTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active"
              id="info-tab"
              data-bs-toggle="tab"
              data-bs-target="#info"
              type="button"
            >
              <i class="bi bi-info-circle-fill"></i>
              <span>Información</span>
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="schedule-tab"
              data-bs-toggle="tab"
              data-bs-target="#schedule"
              type="button"
            >
              <i class="bi bi-clock-fill"></i>
              <span>Horario</span>
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="address-tab"
              data-bs-toggle="tab"
              data-bs-target="#address"
              type="button"
            >
              <i class="bi bi-geo-alt-fill"></i>
              <span>Dirección</span>
            </button>
          </li>
        </ul>
      </div>

      <!-- Tab Content -->
      <div class="tab-content" id="contractTabContent">
        <!-- Info Tab -->
        <div class="tab-pane fade show active" id="info" role="tabpanel">
          <div class="info-grid">
            <!-- Personal Info -->
            <div class="info-card">
              <div class="info-card-header">
                <div class="info-card-icon primary">
                  <i class="bi bi-person-fill"></i>
                </div>
                <h3 class="info-card-title">Datos Personales</h3>
              </div>
              <div class="info-item">
                <span class="info-label">Email</span>
                <span class="info-value" th:text="${contract.email}">
                  email@ejemplo.com
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">CUIL</span>
                <span
                  class="info-value"
                  th:text="${contract.identificationNumber}"
                >
                  00-00000000-0
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">Teléfono</span>
                <span class="info-value" th:text="${contract.phone}">
                  +54 9 11 1234-5678
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">Fecha de Nacimiento</span>
                <span
                  class="info-value"
                  th:text="${#temporals.format(contract.birthdate, 'dd/MM/yyyy')}"
                >
                  01/01/1990
                </span>
              </div>
            </div>

            <!-- Contract Info -->
            <div class="info-card">
              <div class="info-card-header">
                <div class="info-card-icon success">
                  <i class="bi bi-file-earmark-check-fill"></i>
                </div>
                <h3 class="info-card-title">Información del Contrato</h3>
              </div>
              <div class="info-item">
                <span class="info-label">Puesto</span>
                <span class="info-value" th:text="${contract.jobType.label}">
                  Tipo de Trabajo
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">Tipo de Empleo</span>
                <span
                  class="info-value"
                  th:text="${contract.employmentType.label}"
                >
                  Tipo
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">Salario</span>
                <span class="info-value">
                  $<span
                    th:text="${#numbers.formatDecimal(contract.salary, 1, 'COMMA', 2, 'POINT')}"
                  >
                    0.00
                  </span>
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">Fecha de Inicio</span>
                <span
                  class="info-value"
                  th:text="${#temporals.format(contract.since, 'dd/MM/yyyy')}"
                >
                  01/01/2024
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">Antigüedad</span>
                <span class="info-value">
                  <span th:text="${contract.service}">0</span> años
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Schedule Tab -->
        <div class="tab-pane fade" id="schedule" role="tabpanel">
          <div
            th:if="${contract.entries != null and !#lists.isEmpty(contract.entries)}"
            class="schedule-table"
          >
            <table>
              <thead>
                <tr>
                  <th>Día</th>
                  <th>Hora de Entrada</th>
                  <th>Hora de Salida</th>
                  <th>Total Horas</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="entry : ${contract.entries}">
                  <td>
                    <span class="day-badge" th:text="${entry.dayOfWeek}">
                      Lunes
                    </span>
                  </td>
                  <td>
                    <span class="time-badge">
                      <i class="bi bi-clock"></i>
                      <span
                        th:text="${#temporals.format(entry.startTime, 'HH:mm')}"
                      >
                        09:00
                      </span>
                    </span>
                  </td>
                  <td>
                    <span class="time-badge">
                      <i class="bi bi-clock"></i>
                      <span
                        th:text="${#temporals.format(entry.endTime, 'HH:mm')}"
                      >
                        17:00
                      </span>
                    </span>
                  </td>
                  <td>
                    <strong
                      th:text="${T(java.time.Duration).between(entry.startTime, entry.endTime).toHours()} + ' horas'"
                    >
                      8 horas
                    </strong>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div
            th:if="${contract.entries == null or #lists.isEmpty(contract.entries)}"
            class="empty-schedule"
          >
            <i class="bi bi-calendar-x"></i>
            <h4>No hay horarios registrados</h4>
            <p>Este contrato no tiene un horario definido</p>
          </div>
        </div>

        <!-- Address Tab -->
        <div class="tab-pane fade" id="address" role="tabpanel">
          <div class="info-card">
            <div class="info-card-header">
              <div class="info-card-icon info">
                <i class="bi bi-geo-alt-fill"></i>
              </div>
              <h3 class="info-card-title">Dirección Completa</h3>
            </div>
            <div class="info-item">
              <span class="info-label">Calle y Número</span>
              <span class="info-value">
                <span th:text="${contract.street}">Calle</span>
                <span th:text="${contract.number}">123</span>
              </span>
            </div>
            <div
              class="info-item"
              th:if="${contract.apartment != null and contract.apartment != ''}"
            >
              <span class="info-label">Departamento</span>
              <span class="info-value" th:text="${contract.apartment}">
                5A
              </span>
            </div>
            <div class="info-item">
              <span class="info-label">Localidad</span>
              <span class="info-value" th:text="${contract.city}">
                Ciudad
              </span>
            </div>
            <div class="info-item">
              <span class="info-label">Provincia</span>
              <span class="info-value" th:text="${contract.state}">
                Provincia
              </span>
            </div>
            <div class="info-item">
              <span class="info-label">Código Postal</span>
              <span class="info-value" th:text="${contract.postalCode}">
                0000
              </span>
            </div>
            <div class="info-item">
              <span class="info-label">País</span>
              <span class="info-value" th:text="${contract.country}">
                País
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
