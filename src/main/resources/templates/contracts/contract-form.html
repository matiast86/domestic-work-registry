<!DOCTYPE html>
<html
  lang="es"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{fragments/layout}"
>
  <head>
    <title>Nuevo Contrato | DomesticWork</title>
    <th:block layout:fragment="styles">
      <link rel="stylesheet" th:href="@{/css/forms.css}" />
    </th:block>
  </head>

  <body>
    <div layout:fragment="content">
      <div class="form-container">
        <!-- Form Header -->
        <div class="form-header-create fade-in">
          <h1>
            <i class="bi bi-file-earmark-plus me-2"></i>
            Nuevo Contrato
          </h1>
          <p>Creá un contrato y registrá un nuevo empleado</p>
        </div>

        <!-- Form Card -->
        <div class="form-card slide-in">
          <form
            th:action="@{/contracts/save}"
            th:object="${employeeForm}"
            method="post"
            class="needs-validation"
          >
            <!-- Employee Data Section -->
            <div class="form-section">
              <div class="form-section-header">
                <div class="form-section-icon">
                  <i class="bi bi-person-fill"></i>
                </div>
                <h3 class="form-section-title">Datos del Empleado</h3>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="firstName" class="form-label-enhanced">
                      <i class="bi bi-person"></i>
                      Nombre <span class="required">*</span>
                    </label>
                    <input
                      type="text"
                      th:field="*{firstName}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('firstName')} ? 'is-invalid'"
                      placeholder="Nombre del empleado"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('firstName')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{firstName}"></span>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="lastName" class="form-label-enhanced">
                      <i class="bi bi-person"></i>
                      Apellido <span class="required">*</span>
                    </label>
                    <input
                      type="text"
                      th:field="*{lastName}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('lastName')} ? 'is-invalid'"
                      placeholder="Apellido del empleado"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('lastName')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{lastName}"></span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="email" class="form-label-enhanced">
                      <i class="bi bi-envelope"></i>
                      Correo Electrónico <span class="required">*</span>
                    </label>
                    <input
                      type="email"
                      th:field="*{email}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('email')} ? 'is-invalid'"
                      placeholder="correo@ejemplo.com"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('email')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{email}"></span>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="phone" class="form-label-enhanced">
                      <i class="bi bi-telephone"></i>
                      Teléfono
                    </label>
                    <input
                      type="text"
                      th:field="*{phone}"
                      class="form-control"
                      placeholder="+54 9 11 1234-5678"
                    />
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label
                      for="identificationNumber"
                      class="form-label-enhanced"
                    >
                      <i class="bi bi-card-text"></i>
                      CUIL <span class="required">*</span>
                    </label>
                    <input
                      type="text"
                      th:field="*{identificationNumber}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('identificationNumber')} ? 'is-invalid'"
                      placeholder="20-12345678-9"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('identificationNumber')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{identificationNumber}"></span>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="birthDate" class="form-label-enhanced">
                      <i class="bi bi-calendar-event"></i>
                      Fecha de Nacimiento <span class="required">*</span>
                    </label>
                    <input
                      type="date"
                      th:field="*{birthDate}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('birthDate')} ? 'is-invalid'"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('birthDate')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{birthDate}"></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Contract Information Section -->
            <div class="form-section">
              <div class="form-section-header">
                <div class="form-section-icon">
                  <i class="bi bi-file-earmark-text"></i>
                </div>
                <h3 class="form-section-title">Información del Contrato</h3>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="since" class="form-label-enhanced">
                      <i class="bi bi-calendar-event"></i>
                      Fecha de Inicio <span class="required">*</span>
                    </label>
                    <input
                      type="date"
                      th:field="*{since}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('since')} ? 'is-invalid'"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('since')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{since}"></span>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="salary" class="form-label-enhanced">
                      <i class="bi bi-cash-stack"></i>
                      Salario <span class="required">*</span>
                    </label>
                    <input
                      type="number"
                      step="0.01"
                      th:field="*{salary}"
                      class="form-control"
                      placeholder="0.00"
                      required
                    />
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="jobType" class="form-label-enhanced">
                      <i class="bi bi-briefcase"></i>
                      Puesto <span class="required">*</span>
                    </label>
                    <select
                      th:field="*{jobType}"
                      class="form-select"
                      th:classappend="${#fields.hasErrors('jobType')} ? 'is-invalid'"
                      required
                    >
                      <option value="">-- Seleccione un puesto --</option>
                      <option
                        th:each="type : ${T(com.springboot.domesticworkregistry.enums.JobType).values()}"
                        th:value="${type}"
                        th:text="${type.label}"
                      ></option>
                    </select>
                    <div
                      th:if="${#fields.hasErrors('jobType')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{jobType}"></span>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="employmentType" class="form-label-enhanced">
                      <i class="bi bi-clock-history"></i>
                      Tipo de Empleo <span class="required">*</span>
                    </label>
                    <select
                      th:field="*{employmentType}"
                      class="form-select"
                      th:classappend="${#fields.hasErrors('employmentType')} ? 'is-invalid'"
                      required
                    >
                      <option value="">-- Seleccione tipo --</option>
                      <option
                        th:each="type : ${T(com.springboot.domesticworkregistry.enums.EmploymentType).values()}"
                        th:value="${type}"
                        th:text="${type.label}"
                      ></option>
                    </select>
                    <div
                      th:if="${#fields.hasErrors('employmentType')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{employmentType}"></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Schedule Section -->
            <div class="form-section">
              <div class="form-section-header">
                <div class="form-section-icon">
                  <i class="bi bi-clock-fill"></i>
                </div>
                <h3 class="form-section-title">Horario de Trabajo</h3>
              </div>

              <div class="schedule-table-container">
                <table class="schedule-table" id="scheduleTable">
                  <thead>
                    <tr>
                      <th>Día</th>
                      <th>Hora Inicio</th>
                      <th>Hora Fin</th>
                      <th style="width: 80px"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr th:each="entry, iterStat : *{entries}">
                      <td>
                        <select
                          th:field="*{entries[__${iterStat.index}__].dayOfWeek}"
                          class="form-select"
                        >
                          <option value="" disabled selected>
                            Seleccionar día
                          </option>
                          <option
                            th:each="day : ${T(java.time.DayOfWeek).values()}"
                            th:value="${day}"
                            th:text="${day.getDisplayName(T(java.time.format.TextStyle).FULL, T(java.util.Locale).forLanguageTag('es-AR')).toUpperCase()}"
                          ></option>
                        </select>
                      </td>
                      <td>
                        <input
                          type="time"
                          th:field="*{entries[__${iterStat.index}__].startTime}"
                          class="form-control"
                        />
                      </td>
                      <td>
                        <input
                          type="time"
                          th:field="*{entries[__${iterStat.index}__].endTime}"
                          class="form-control"
                        />
                      </td>
                      <td class="text-center">
                        <button
                          type="button"
                          class="btn-remove-row"
                          onclick="removeRow(this)"
                          title="Eliminar fila"
                        >
                          <i class="bi bi-x-lg"></i>
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <button type="button" class="btn-add-row" onclick="addRow()">
                <i class="bi bi-plus-circle-fill"></i>
                Agregar Día
              </button>
            </div>

            <!-- Address Section -->
            <div class="form-section">
              <div class="form-section-header">
                <div class="form-section-icon">
                  <i class="bi bi-geo-alt-fill"></i>
                </div>
                <h3 class="form-section-title">Dirección</h3>
              </div>

              <div class="row">
                <div class="col-md-8">
                  <div class="form-group-enhanced">
                    <label for="street" class="form-label-enhanced">
                      <i class="bi bi-signpost"></i>
                      Calle <span class="required">*</span>
                    </label>
                    <input
                      type="text"
                      th:field="*{street}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('street')} ? 'is-invalid'"
                      placeholder="Nombre de la calle"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('street')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{street}"></span>
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="form-group-enhanced">
                    <label for="number" class="form-label-enhanced">
                      <i class="bi bi-123"></i>
                      Número <span class="required">*</span>
                    </label>
                    <input
                      type="text"
                      th:field="*{number}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('number')} ? 'is-invalid'"
                      placeholder="1234"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('number')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{number}"></span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-4">
                  <div class="form-group-enhanced">
                    <label for="apartment" class="form-label-enhanced">
                      <i class="bi bi-door-closed"></i>
                      Departamento
                    </label>
                    <input
                      type="text"
                      th:field="*{apartment}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('apartment')} ? 'is-invalid'"
                      placeholder="5A (opcional)"
                    />
                    <div
                      th:if="${#fields.hasErrors('apartment')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{apartment}"></span>
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="form-group-enhanced">
                    <label for="country" class="form-label-enhanced">
                      <i class="bi bi-globe"></i>
                      País <span class="required">*</span>
                    </label>
                    <select
                      th:field="*{country}"
                      class="form-select"
                      th:classappend="${#fields.hasErrors('country')} ? 'is-invalid'"
                      id="country"
                      required
                    >
                      <option value="">-- Seleccione --</option>
                    </select>
                    <div
                      th:if="${#fields.hasErrors('country')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{country}"></span>
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="form-group-enhanced">
                    <label for="state" class="form-label-enhanced">
                      <i class="bi bi-map"></i>
                      Provincia <span class="required">*</span>
                    </label>
                    <select
                      th:field="*{state}"
                      class="form-select"
                      th:classappend="${#fields.hasErrors('state')} ? 'is-invalid'"
                      id="state"
                      required
                    >
                      <option value="">-- Seleccione --</option>
                    </select>
                    <div
                      th:if="${#fields.hasErrors('state')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{state}"></span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="city" class="form-label-enhanced">
                      <i class="bi bi-building"></i>
                      Localidad <span class="required">*</span>
                    </label>
                    <input
                      type="text"
                      th:field="*{city}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('city')} ? 'is-invalid'"
                      placeholder="Ciudad o localidad"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('city')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{city}"></span>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group-enhanced">
                    <label for="postalCode" class="form-label-enhanced">
                      <i class="bi bi-mailbox"></i>
                      Código Postal <span class="required">*</span>
                    </label>
                    <input
                      type="text"
                      th:field="*{postalCode}"
                      class="form-control"
                      th:classappend="${#fields.hasErrors('postalCode')} ? 'is-invalid'"
                      placeholder="1234"
                      required
                    />
                    <div
                      th:if="${#fields.hasErrors('postalCode')}"
                      class="invalid-feedback d-flex align-items-center gap-2"
                    >
                      <i class="bi bi-exclamation-circle-fill"></i>
                      <span th:errors="*{postalCode}"></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
              <a th:href="@{/dashboard}" class="btn btn-outline-secondary">
                <i class="bi bi-x-circle me-2"></i>
                Cancelar
              </a>
              <button type="submit" class="btn btn-success">
                <i class="bi bi-check-circle-fill me-2"></i>
                Crear Contrato
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script th:src="@{/js/forms.js}" layout:fragment="scripts"></script>
  </body>
</html>
